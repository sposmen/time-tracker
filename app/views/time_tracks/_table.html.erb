<table class="table table-striped">
  <thead>
  <tr>
    <th>Description</th>
    <th>Start at</th>
    <th>End at</th>
    <th>Current time</th>
    <th>Actions</th>
  </tr>
  </thead>

  <%
    total_time = 0.seconds
    @time_tracks.each do |time_track|
      current_time = (time_track.end_at || Time.current) - time_track.start_at
      total_time += current_time
  %>
    <tr class="table-<%= time_track.end_at.nil? ? 'danger' : 'success' %>">
      <td><%= time_track.description %></td>
      <td><%= time_tag(time_track.start_at, format: '%I:%M%p') %></td>
      <td><%= time_tag(time_track.end_at, format: '%I:%M%p') if time_track.end_at %></td>
      <td><%= (current_time / (3600)).round(2) %></td>
      <td>
        <%= link_to 'Edit', edit_time_track_path(time_track), class: 'btn btn-secondary btn-sm' %>
        <% if !time_track.end_at.nil? %>
          <%= link_to 'Duplicate', time_track_duplicate_path(time_track), class: 'btn btn-warning btn-sm' %>
        <% else %>
          <%= link_to 'Stop', time_track_stop_path(time_track), class: 'btn btn-danger btn-sm' %>
        <% end %>
        <%= link_to 'Destroy', time_track, method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-dark btn-sm' %>
      </td>
    </tr>
  <% end %>
  <tr>
    <th colspan="3">Total Time</th>
    <th><%= (total_time / (3600)).round(2) %> Hours</th>
    <th></th>
  </tr>
</table>
